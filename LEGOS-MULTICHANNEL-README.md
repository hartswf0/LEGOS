# LEGOS Multi-Channel Liberation Engine

**Liberation Engine Grid Ontology Synthesizer â€” Multi-Channel Edition**

A hyperclay narrative engine for branching ethical simulation, perspective-shifting, and multi-timeline scenario exploration. Built as a single-file HTML application with OpenAI integration.

---

## ğŸŒŸ Overview

LEGOS Multi-Channel transforms narrative into **malleable spacetime**. Unlike linear storytelling tools, LEGOS treats scenes as **hyperclay** â€” material that actively reshapes itself through:

- **Grid-based ontology**: 9Ã—9 spatial reasoning canvas
- **Multi-channel branching**: Parallel timelines with fork/merge semantics
- **Tetrad interventions**: McLuhan-inspired transformative choices
- **Entity perspectives**: First-person POV from any grid element
- **Ring memory**: 48-entry circular narrative cache

---

## ğŸ¯ Core Concepts

### 1. **The Grid** (9Ã—9 Spatial Ontology)

The grid is not a map â€” it's an **ontological field**:

- **Proximity = Relationship Strength**: Close entities have stronger bonds
- **Empty Space = Tension**: Distance creates narrative pressure
- **8-14 Elements**: Optimal density for dramatic transformation
- **Block Types**: Entity, Location, Obstacle, Solution, Goal

**Philosophy**: Spatial arrangements embody power dynamics, emotional states, and narrative momentum.

### 2. **Hyperclay Transformation**

Scenes don't merely change â€” they **metabolize**:

```
HYPERCLAY RULES:
- 2-4 REMOVALS per beat (elements fade/vanish)
- 2-4 ADDITIONS per beat (new complications emerge)
- Dramatic state changes (entities transform)
- The world is ALIVE and REACTIVE
```

**Not**: Shuffling pieces around  
**But**: Elements appear, morph, dissolve â€” the grid breathes

### 3. **Multi-Channel Architecture**

Channels are **branching realities**:

- **Fork Modes**: Continue, Enhance, Reverse, Retrieve, Obsolesce, Perspective, Snapshot
- **Parallel Timelines**: Each channel maintains independent state
- **Color-Coded**: Visual differentiation (7 colors in palette)
- **Git-Style Semantics**: Parent references, fork origins, lineage tracking

**Use Cases**:
- Explore "what if" scenarios without losing progress
- Compare ethical decisions across timelines
- Track how perspective shifts change outcomes

### 4. **Tetrad Interventions**

McLuhan's **tetrad** as narrative engine:

```
â–² ENHANCE: What amplifies?
â‡„ REVERSE: What inverts?
â†º RETRIEVE: What returns?
â–¼ OBSOLESCE: What fades?
```

**Integration**:
- Auto-generates after each scene
- Appears as chat message (not separate panel)
- Click any option â†’ fills input
- Red ball button (â†’) to send
- Can be generated from **entity perspectives**

### 5. **Ring Memory** (Circular Narrative Cache)

**48-entry rotating buffer** capturing:
- Scenes composed
- Perspectives analyzed
- Snapshots taken
- Fork events

**Context Modes**:
- **All**: Full ring visible
- **Recent**: Last N entries
- **Anchor**: From specific point forward
- **Mainline**: Single narrative thread

**Visual**: Top-of-screen ribbon with color-coded dots

---

## ğŸš€ Getting Started

### Prerequisites

- Modern web browser (Chrome, Firefox, Safari, Edge)
- OpenAI API key (stored locally, never transmitted except to OpenAI)

### Launch

1. Open `legos-liberation-engine-multichannel.html` in browser
2. Click **â— (top right)** â†’ **STORE KEY**
3. Enter OpenAI API key (sk-...)
4. Click **+** (top left) to create first channel
5. Select scenario or start with **Blank Canvas**

### First Scene

```
1. Type in text input: "A hacker in a server room, surrounded by glowing screens"
2. Press SEND or Enter
3. Watch grid populate with entities
4. Tetrad options appear automatically
5. Click âœ¦ (footer) to set entity perspective
```

---

## ğŸ“– User Interface

### Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RING BAR (48 memories)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚ CH1  â”‚  CH2  â”‚  CH3  â”‚ â† Horizontal scroll
â”‚  â”‚      â”‚      â”‚      â”‚
â”‚  â”‚ GRID â”‚ GRID â”‚ GRID â”‚
â”‚  â”‚      â”‚      â”‚      â”‚
â”‚  â”‚ CHAT â”‚ CHAT â”‚ CHAT â”‚
â”‚  â”‚      â”‚      â”‚      â”‚
â”‚  â”‚[INPUT]â”‚[INPUT]â”‚[INPUT]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [SCENARIO SELECTOR]  [âœ¦ PERSPECTIVE]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Grid Cell Colors

- **Entity**: Bright accent
- **Location**: Soft accent
- **Obstacle**: Border emphasis
- **Solution**: Success green
- **Goal**: Highlight glow

### Message Types

- **User**: Lighter color dot
- **Assistant**: Channel color dot
- **System**: Muted color, small
- **Tetrad**: Special role with 4 options

### Controls

**Top Left**:
- **+**: New channel
- **â†“**: Import state
- **âš¡**: Snapshots
- **âŠš**: Ring context

**Top Right**:
- **â—**: Info menu (API key, help, themes, fullscreen)

**Footer**:
- **Scenario Dropdown**: Switch channel scenario
- **âœ¦ Button**: Set entity perspective for tetrad

**Grid Cell Click**:
- View entity details
- **RUN ELEMENT PERSPECTIVE**: Analyze from entity's POV
- **SET TETRAD PERSPECTIVE**: Generate tetrad from this viewpoint

**Message Dot Click**:
- **Single Click**: Fork from this message
- Options: Continue, Enhance, Reverse, Retrieve, Obsolesce

---

## ğŸ® Core Workflows

### 1. Basic Narrative Flow

```
User: "Maya presents data to the board"
  â†“
System: Grid updates (Maya, Board, Data, Tension)
  â†“
Tetrad: [â–² Enhance, â‡„ Reverse, â†º Retrieve, â–¼ Obsolesce]
  â†“
User: Clicks "â–² Enhance" option
  â†“
System: New scene with amplified stakes
```

### 2. Perspective Shifting

```
1. Click grid cell (e.g., "VP Growth")
2. Click "RUN ELEMENT PERSPECTIVE"
3. Modal shows:
   - Perspective analysis
   - Emotional state
   - Plot impact
   - Next action
4. Tap any field to select
5. Red ball appears â†’ Click to send to input
6. Modal auto-closes
```

### 3. Timeline Branching

```
1. Tap message dot (e.g., message #5)
2. Choose fork mode (e.g., "Reverse")
3. New channel created from that point
4. Both timelines continue independently
5. Compare outcomes side-by-side
```

### 4. Snapshot Management

```
1. Click âš¡ (top left)
2. Name snapshot (e.g., "Before Board Meeting")
3. Continue exploring
4. Later: Click âš¡ â†’ Select snapshot â†’ Restore
5. All channels revert to that state
```

### 5. Entity-Perspective Tetrad

```
1. Compose scene with multiple entities
2. Click âœ¦ (footer button)
3. Select entity (e.g., "Dev Kumar")
4. Tetrad regenerates from Dev's viewpoint
5. Options reflect his concerns/fears/desires
6. Grid cell pulses to show selected entity
```

---

## ğŸ§  Scenarios

### Blank Canvas
- **Purpose**: Free-form narrative creation
- **Best For**: Original worlds, experimentation
- **Constraints**: None

### Maya Chen (Corporate Whistleblower)
- **Role**: L&D Lead @ Agronica
- **Goal**: Expose compulsive design patterns
- **Obstacle**: VP Growth blocks truth
- **Power**: 0.20 (low) vs VP 0.85 (high)
- **Stakes**: Mortgage, family, review in 2 weeks

### Dev Kumar (Ethical AI Engineer)
- **Role**: Lead ML Engineer @ TalentFarm
- **Goal**: Fix 3.2Ã— discrimination in AI
- **Obstacle**: VP Engineering under launch pressure
- **Power**: 0.22 (low) vs VP 0.82 (high)
- **Stakes**: H-1B visa, remittances, green card process

---

## ğŸ¨ Themes

### CRT GREEN (Default)
- Dark terminal aesthetic
- High contrast, retro-futuristic
- Green/black color scheme

### PARCHMENT
- Warm, manuscript-inspired
- Sepia tones, calligraphic feel
- Ideal for historical scenarios

### THOUSAND LIVES
- Dark crimson/red palette
- Dramatic, intense atmosphere
- Named after philosophical concept

**Switch**: Click **â—** â†’ **CYCLE THEME**

---

## ğŸ”§ Technical Architecture

### Single-File Design

**Why**: Zero dependencies, instant deployment, privacy-first

**Structure**:
```
- HTML (structure)
- CSS (all themes inline)
- JavaScript (full engine)
- No external files except OpenAI API
```

### State Management

```javascript
appState = {
  apiKey: string,           // Local storage only
  theme: string,            // Active theme ID
  channels: Array<Channel>, // All timeline states
  currentChannelId: string, // Active focus
  snapshots: Array<State>,  // Named save points
  channelSequence: number   // Auto-increment ID
}
```

### Channel Schema

```javascript
Channel = {
  id: string,                // CH00000001
  name: string,              // Display name
  scenario: string,          // Scenario ID
  channelColor: string,      // Hex color
  grid: Array<Array<Cell>>,  // 9Ã—9 matrix
  messages: Array<Message>,  // Chat history
  tetrad: Object,            // Current options
  tetradPerspective: string, // Entity filter
  lastScene: Object,         // Scene JSON
  observer: Object,          // Plot tracking
  forkPoint: Object,         // Parent reference
  ringBinding: string        // Ring memory ID
}
```

### API Integration

**Model**: `gpt-4o-mini`  
**Endpoints**: OpenAI Chat Completions  
**Formats**: JSON objects only

**SceneAssembler**:
- Temperature: 0.7 (creative)
- Max tokens: 2500
- Prompt: Hyperclay transformation rules

**TetradGenerator**:
- Temperature: 0.8 (wild)
- Max tokens: 600
- Prompt: McLuhan-inspired options

**PerspectiveAnalyzer**:
- Temperature: 0.7
- Max tokens: 800
- Prompt: First-person entity analysis

---

## ğŸ“± Mobile Optimization

### Keyboard Handling

- **Sticky input**: `position: sticky; bottom: 0`
- **Visual Viewport API**: Detects keyboard height
- **Auto-scroll**: Input stays visible during typing
- **Dynamic viewport**: Uses `100dvh` when supported

### Touch Interactions

- **Tap-to-select**: Fields highlight, red ball appears
- **Bounce animation**: Elastic easing for feedback
- **Auto-close modals**: After sending to input
- **Horizontal scroll**: Smooth channel navigation

### Responsive Grid

- **Column width**: `min(100vw, 420px)`
- **Font scaling**: `clamp(11px, 2.4vw, 13px)`
- **Touch targets**: Minimum 40px for buttons

---

## ğŸ’¾ Data Persistence

### Local Storage Keys

```
legos/multi-channel/state   â†’ Full app state
legos/multi-channel/key     â†’ OpenAI API key
```

### Export Format

**JSON Structure**:
```json
{
  "version": "1.0",
  "timestamp": "ISO-8601",
  "channels": [...],
  "ringMemory": {...},
  "snapshots": [...]
}
```

### Import/Export

1. **Export**: **â†“** button â†’ Downloads JSON
2. **Import**: **â†“** button â†’ Select file â†’ Merges state
3. **Snapshots**: Named checkpoints within session

---

## ğŸ¯ Advanced Features

### 1. JSON Repair

Handles truncated API responses:
```
- Detects incomplete structures
- Counts open/close braces
- Removes incomplete strings
- Closes all open objects
- Attempts parse
```

### 2. Animated Transitions

- **Grid cells**: Fade in/out based on changes
- **Disappearing elements**: Red tint + spin
- **New elements**: Scale up + glow
- **Position changes**: Smooth translate

### 3. Relational Scoring

Computes **relationship strength** between entities:
```
- Proximity weight
- Connection count
- Semantic similarity
- Displays as percentages
```

### 4. Cell History

Each grid cell logs:
- Placement events
- User modifications
- Message IDs
- Timestamps

**Access**: Click cell â†’ See history dots

---

## ğŸ” Privacy & Security

### API Key Storage

- **Local only**: Never leaves your browser
- **localStorage**: Persists across sessions
- **No analytics**: Zero telemetry
- **Direct OpenAI**: No proxy servers

### Data Export

- **User controlled**: Manual export only
- **JSON format**: Human-readable
- **No cloud sync**: Stays on device

---

## ğŸ› Troubleshooting

### "Empty response from API"
**Fix**: Check API key validity, network connection

### Grid not updating
**Fix**: Ensure 8-14 elements requested, check console for errors

### Keyboard covers input (mobile)
**Fix**: Should auto-scroll; if not, tap input to focus

### Tetrad not generating
**Fix**: Compose scene first, check API key, view console logs

### Channel colors all the same
**Fix**: Refresh page to reset color palette

---

## ğŸ“š Keyboard Shortcuts

- **Enter**: Send message
- **Shift+Enter**: New line in input
- **Click message dot**: Fork timeline
- **Click grid cell**: View details
- **Tap field in modal**: Show send button

---

## ğŸ“ Best Practices

### 1. Start Simple

Begin with 3-5 entities, add complexity gradually

### 2. Use Perspectives

Switch viewpoints to uncover hidden dynamics

### 3. Fork Often

Explore alternatives without losing progress

### 4. Name Snapshots

Take saves at key decision points

### 5. Watch Proximity

Entities near each other = strong relationships

### 6. Read Tetrad Options

They reveal narrative momentum

### 7. Embrace Hyperclay

Let elements appear/vanish dynamically

---

## ğŸš€ Future Development

Potential enhancements:

- **Multi-user sessions**: Collaborative branching
- **Custom scenarios**: User-defined templates
- **Export to video**: Animated grid playback
- **Voice input**: Speech-to-text composition
- **Plugin system**: Extend with custom analyzers

---

## ğŸ“œ License

Single-file HTML application â€” use, modify, distribute freely.

**Attribution**: LEGOS Multi-Channel Liberation Engine

---

## ğŸ™ Acknowledgments

- **Marshall McLuhan**: Tetrad methodology
- **Spencer-Brown**: Laws of Form inspiration
- **Git**: Branching semantics
- **Tone.js**: Audio feedback system

---

## ğŸ“ Support

For issues, enhancements, or questions:
- Check browser console for error logs
- Verify OpenAI API key has credits
- Ensure modern browser (Chrome 90+, Safari 14+, Firefox 88+)

---

**Built for storytellers, ethicists, and worldbuilders who see narrative as hyperclay â€” material that reshapes itself through attention and intervention.**

âœ¦ LEGOS â€” Liberation through spatial ontology âœ¦
